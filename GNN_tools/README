code provided by Luke van Poppering.
